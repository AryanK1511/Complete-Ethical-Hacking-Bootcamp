# Vulnerability Analysis

## Finding first vulnerability with nmap scripts

- Nmap can be used for vulnerability analysis and even exploitation using scripts
- Scripts are located in `/usr/share/nmap/scripts/`
- NSE documentation: [nmap.org/book/nse-usage.html](https://nmap.org/book/nse-usage.html)

### Running Nmap Scripts

#### Script Groups

Run a script group with: `sudo nmap --script=<group> <target>`

**Common script groups:**

- **auth**: Authentication credentials or bypass methods
- **brute**: Brute force attacks for credential discovery
- **malware**: Tests for malware/backdoor infections
- **banner**: Retrieves service banners (helpful for version detection)
- **exploit**: Actively attempts to exploit vulnerabilities
- **vuln**: Checks for specific vulnerabilities
- **discovery**: Discovers more information about the network
- **default**: Basic scripts that run with `-sC` option

#### Single Scripts

Run a single script with: `sudo nmap --script=<script-name> <target>`

Get script documentation with: `sudo nmap --script-help=<script-name>`

### Practical Examples & Discovered Vulnerabilities

#### FTP (Port 21)

- Anonymous FTP login allowed (discovered with `ftp-anon.nse`)
- Vulnerable and exploitable (per exploit script group)
- To test anonymous login:

  ```bash
  ftp <target-IP>
  Username: anonymous
  Password: [anything]
  ```

#### SSH (Port 22)

- Authentication methods reported by auth script group

#### MySQL (Port 3306)

- Root account has empty password (discovered with auth scripts)

#### Tomcat (Port 8180)

- Default credentials "tomcat:tomcat" work
- Grants access to Tomcat administration panel
- Access via browser: http://[target-IP]:8180
- Navigate to admin section and login with default credentials

#### HTTP (Port 80)

- Possible CSRF vulnerabilities detected (requires further web pentesting)
- Identified by the exploit script group

### Vulnerability Classification

- Vulnerabilities often labeled with IDs (e.g., CVE-2011-xxxx)
- Year prefix indicates when vulnerability was discovered

### Tips for Effective Script Usage

- Combine with other scan options: `sudo nmap -sS -F --script=<group> <target>`
- `-F` for faster scanning (100 most common ports)
- Read script documentation before running to understand functionality
- Verify vulnerabilities manually when possible
- Not all scripts will produce output for every target

## Manual Vulnerability Analysis and Searchsploit

- If you find an exploit, google search it, get the source code and then read through it. Then, you can use this exploit to exploit the target.
- You can also use `searchsploit` to find exploits in something.
- Use the `locate` command to find where the exploits are located on your machine.

## Using `Nessus`

Nessus is a powerful vulnerability scanner developed by Tenable that identifies security weaknesses, misconfigurations, and missing patches in various systems and networks.

### Scan Types

- **Basic Network Scan**: General vulnerability assessment for network devices
- **Advanced Scan**: Customizable scan with extensive options
- **Web Application Scan**: Focuses on web applications for vulnerabilities like XSS, SQL injection
- **Compliance Checks**: Evaluates systems against compliance standards (CIS, DISA, PCI DSS)
- **Credentialed Scan**: Uses login credentials for deeper system inspection
- **Host Discovery**: Identifies active hosts without full vulnerability checks

### Creating and Running a Scan

1. Select "New Scan" from the dashboard
2. Choose scan template based on your needs
3. Configure scan settings:
   - Name and description
   - Target (IP, range, or hostname)
   - Schedule (immediate, recurring, or scheduled)
   - Credentials (if using authenticated scanning)
   - Advanced settings (port ranges, plugin selection)
4. Launch scan and monitor progress
5. Review results when complete

### Understanding Results

- **Critical/High**: Vulnerabilities requiring immediate attention
- **Medium**: Less urgent but should be addressed
- **Low/Info**: Informational findings and minor issues
- Each vulnerability includes:
  - Description of the issue
  - Affected systems
  - Risk information
  - Remediation steps
  - Technical details and references

### Best Practices

- Run scans during low-traffic periods
- Use credentials when possible for thorough results
- Create scan policies for consistent testing
- Regularly update plugins for latest vulnerability checks
- Export reports for documentation and tracking
- Configure scan throttling to prevent network disruption

### Integration Options

- Export results to ticketing systems
- API access for automation
- Integration with SIEM tools
- Compliance reporting frameworks
